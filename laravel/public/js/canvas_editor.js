/*! For license information please see canvas_editor.js.LICENSE.txt */
!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/",i(i.s=2)}([function(t,e,i){"use strict";function n(t,e,i){return{width:e*(t.coordinates.x2-t.coordinates.x1),height:i*(t.coordinates.y2-t.coordinates.y1),x:e*t.coordinates.x1,y:i*t.coordinates.y1}}function r(t){return""!=t&&t!=location.href&&t!=location.origin&&t!=location.origin+"/"}function o(t,e,i,n,r,o,a,s){t.drawImage(e,0,0,a/2,s,i,n,r/2,o)}function a(t,e,i,n,r,o,a,s){t.drawImage(e,a/2,0,a/2,s,i+r/2,n,r/2,o)}function s(t,e){var i=t.x2-t.x1,n=t.y2-t.y1,r={x1:0,x2:0,y1:0,y2:0};return r.x1=t.x1+i*e.x1,r.x2=t.x1+i*e.x2,r.y1=t.y1+n*e.y1,r.y2=t.y1+n*e.y2,r}function c(t,e){var i=t.x2-t.x1,n=t.y2-t.y1,r={x1:0,x2:0,y1:0,y2:0};return r.x1=(e.x1-t.x1)/i,r.x2=(e.x2-t.x1)/i,r.y1=(e.y1-t.y1)/n,r.y2=(e.y2-t.y1)/n,r}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=[],o=(1-e)*(t.x2-t.x1)*-.25*i,a=(1-e)*(t.y2-t.y1)*-.25*n;return r.x1=t.x1-o,r.x2=t.x2+o,r.y1=t.y1-a,r.y2=t.y2+a,r}function u(t,e,i){try{return(e-t)/i}catch(t){return 0}}function m(t,e,i){var n=document.createElement("canvas"),r=n.getContext("2d");n.width=t.width,n.height=t.height;var o=Math.round(t.width/e/i*100*.618)/100;return o>.33&&(r.filter="blur(".concat(o,"px)")),r.drawImage(t,0,0),n}function d(t,e,i,r,o,a,s,c,l){t.opacity||(i.globalAlpha=a),function(t,e,i,r,o,a,s){if(!function(t){return t.naturalWidth>0}(o))return;var c=n(t,i,r);!function(t,e,i,n,r,o,a,s,c,l,u,d){var h=l?m(a,r,d):a,g=e*Math.PI/180,f=i+r/2,y=n+o/2,p=-r/2,v=-o/2;t.save(),t.translate(f,y),t.rotate(g),null!==c&&(t.filter="brightness(".concat(c,"%)"));null!=u&&u<1&&(t.globalAlpha=u);s?s(t,h,p,v,r,o,a.naturalWidth,a.naturalHeight):t.drawImage(h,p,v,r,o);t.restore()}(e,a,c.x,c.y,c.width,c.height,o,t.drawCallback,t.brightness,t.useAntialiasing,t.opacity,s)}(t,i,r,o,s[e],c,l),i.globalAlpha=1}function h(t,e,i,r,o){e.fillStyle="rgba(255, 50, 50, "+o+")",t.opacity||(e.globalAlpha=o),function(t,e,i,r,o){var a=n(t,i,r);null!=o&&o<1&&(e.globalAlpha=o);e.fillRect(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height))}(t,e,i,r,t.opacity),e.globalAlpha=1}function g(t,e,i,r,o,a){e.strokeStyle="rgba(180, 255, 180, "+o+")",e.lineWidth=a,function(t,e,i,r){var o=n(t,i,r);e.save(),e.translate(Math.round(o.x)+Math.round(o.width)/2,Math.round(o.y)+Math.round(o.height)/2),e.strokeRect(-Math.round(o.width)/2,-Math.round(o.height)/2,Math.round(o.width)-2,Math.round(o.height)-2),e.restore()}(t,e,i,r)}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function p(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==f(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===f(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function v(t,e,i,n,o,a,s,c,l,u){i.clearRect(0,0,n,o);var m=t.map((function(t){return t.linkedItems})).filter((function(t){return t.length>0})).flat(),f=n*a.mainImgScale||n,y=o*a.mainImgScale||o;if("item"===c||"itemWithFrame"===c){var p=function(t,e){var i={},n=[],r=[];for(var o in e.forEach((function(e,r){if(null!==t["item".concat(r,"Layer")]){var o=t["item".concat(r,"Layer")],a=o+(o>=0?1:0)+t.mainImgLayer;i[a]="item".concat(r),n.includes(a)?console.error("Layer already taked by other item","Layer: ",a,"Item: ",r):n.push(a)}else console.error("Set Layer for Item".concat(r,". Current value is NULL"))})),i[t.mainImgLayer]="mainImg",i)r.push(i[o]);return r}(a,t);!function t(e,i,n,o,a,s,c,l,u,m,h,g){if(m.includes(parseInt(e[i].replace("item",""))))return void(i<e.length-1&&t(e,i+1,n,o,a,s,c,l,u,m,h,g));var f=e[i],y="mainImg"!=f?u[parseInt(f.replace("item",""))]:null,p=l.enableRotation&&y?y.angle:0;"mainImg"===f?(b(n,o,a,s,c,l,h,g),i<e.length-1&&t(e,i+1,n,o,a,s,c,l,u,m,h,g)):l["".concat(f,"FullImageMask")]?(n.drawImage(l[f],(o-s)/2,(a-c)/2,s,c),i<e.length-1&&t(e,i+1,n,o,a,s,c,l,u,m,h,g)):r(l[f].src)&&(d(y,f,n,o,a,h,l,p,g),i<e.length-1&&t(e,i+1,n,o,a,s,c,l,u,m,h,g))}(p,0,i,n,o,f,y,a,t,e,l,u),"itemWithFrame"===c&&p.forEach((function(r){if(!e.includes(parseInt(r.replace("item","")))&&"mainImg"!=r){var c=parseInt(r.replace("item","")),d=t[c];!1===a.enableRotation||d.angle;s.includes(c)||m.includes(c)||g(d,i,n,o,l,u)}}))}else b(i,n,o,f,y,a,l,u),t.forEach((function(t,e){"rect"===c?r(a["item".concat(e)].src)&&h(t,i,n,o,l):"frame"===c&&r(a["item".concat(e)].src)&&g(t,i,n,o,l,u)}))}function b(t,e,i,n,o,a,s,c){if(r(a.mainImg.src)){var l=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?y(Object(i),!0).forEach((function(e){p(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}({},a.mainImgCoordinates);1!==a.mainImgScale&&(l.x1=(e-n)/2/e,l.y1=(i-o)/2/i,l.x2=((e-n)/2+n)/e,l.y2=((i-o)/2+o)/i),d({coordinates:l,drawCallback:a.mainImgDrawCallback,brightness:a.mainImgBrightness,opacity:a.mainImgOpacity},"mainImg",t,e,i,s,a,a.mainImgAngle,c)}}function I(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!e)return new Promise((function(e,i){return e(t)}));var s=document.createElement("canvas"),c=s.getContext("2d"),l=new Image;return l.crossOrigin="anonymous",l.src=e,new Promise((function(e,u){l.onload=function(){var m=a||l.naturalHeight,d=o||l.naturalWidth;s.width=d,s.height=m;var h=new Image;h.crossOrigin="anonymous",h.src=t,h.onload=function(){if(c.globalCompositeOperation="destination-over",c.drawImage(l,0,0,d,m),i){var t=n(i,d,m),o=r*Math.PI/180,a=t.x+t.width/2,u=t.y+t.height/2,g=-t.width/2,f=-t.height/2;o&&null!=a&&null!=u&&(c.save(),c.translate(a,u),c.rotate(o)),c.globalCompositeOperation="source-in",i.drawCallback?i.drawCallback(c,h,g,f,t.width,t.height):c.drawImage(h,g,f,t.width,t.height),o&&null!=a&&null!=u&&c.restore()}else c.globalCompositeOperation="source-out",c.drawImage(h,0,0,d,m);e(s.toDataURL("webp"))},h.onerror=function(){u("Image not found")}},l.onerror=function(){u("Mask image not found")}}))}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(){w=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r=Object.defineProperty||function(t,e,i){t[e]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function u(t,e,i,n){var o=e&&e.prototype instanceof y?e:y,a=Object.create(o.prototype),s=new A(n||[]);return r(a,"_invoke",{value:C(t,i,s)}),a}function m(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",h="executing",g="completed",f={};function y(){}function p(){}function v(){}var b={};l(b,a,(function(){return this}));var I=Object.getPrototypeOf,k=I&&I(I(M([])));k&&k!==i&&n.call(k,a)&&(b=k);var O=v.prototype=y.prototype=Object.create(b);function L(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function i(r,o,a,s){var c=m(t[r],t,o);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==x(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){i("next",t,a,s)}),(function(t){i("throw",t,a,s)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return i("throw",t,a,s)}))}s(c.arg)}var o;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){i(t,n,e,r)}))}return o=o?o.then(r,r):r()}})}function C(e,i,n){var r=d;return function(o,a){if(r===h)throw new Error("Generator is already running");if(r===g){if("throw"===o)throw a;return{value:t,done:!0}}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=P(s,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var l=m(e,i,n);if("normal"===l.type){if(r=n.done?g:"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=g,n.method="throw",n.arg=l.arg)}}}function P(e,i){var n=i.method,r=e.iterator[n];if(r===t)return i.delegate=null,"throw"===n&&e.iterator.return&&(i.method="return",i.arg=t,P(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=m(r,e.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,f;var a=o.arg;return a?a.done?(i[e.resultName]=a.value,i.next=e.nextLoc,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,f):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,f)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function M(e){if(e||""===e){var i=e[a];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function i(){for(;++r<e.length;)if(n.call(e,r))return i.value=e[r],i.done=!1,i;return i.value=t,i.done=!0,i};return o.next=o}}throw new TypeError(x(e)+" is not iterable")}return p.prototype=v,r(O,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:p,configurable:!0}),p.displayName=l(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,c,"GeneratorFunction")),t.prototype=Object.create(O),t},e.awrap=function(t){return{__await:t}},L(j.prototype),l(j.prototype,s,(function(){return this})),e.AsyncIterator=j,e.async=function(t,i,n,r,o){void 0===o&&(o=Promise);var a=new j(u(t,i,n,r),o);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(O),l(O,c,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.push(n);return i.reverse(),function t(){for(;i.length;){var n=i.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=M,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function r(n,r){return s.type="throw",s.arg=e,i.next=n,r&&(i.method="next",i.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),E(i),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;E(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={iterator:M(e),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}function k(t,e,i,n,r,o,a){try{var s=t[o](a),c=s.value}catch(t){return void i(t)}s.done?e(c):Promise.resolve(c).then(n,r)}function O(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var o=t.apply(e,i);function a(t){k(o,n,r,a,s,"next",t)}function s(t){k(o,n,r,a,s,"throw",t)}a(void 0)}))}}function L(t,e,i,n,r,o,a,s){var c=[];for(var l in a(!E(i,t)),c.push(function(t,e,i,n,r,o,a){return j.apply(this,arguments)}(i,t,o,i.mainImgUrl,i.mainImgMask,a,s)),t)c.push(C(i,t,"item".concat(l),n,r,o,a));return Promise.all(c)}function j(){return(j=O(w().mark((function t(e,i,n,r,o,a,s){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.mainImgLoaded){t.next=2;break}return t.abrupt("return");case 2:return e.mainImg=new Image,t.abrupt("return",I(r,o).then((function(t){return e.mainImg.src=t,e.mainImg.crossOrigin="anonymous",new Promise((function(t){return e.mainImg.onload=t})).then((function(){s(e.mainImg.width,e.mainImg.height),e.mainImgLoaded=!0,S(e,i,n,a)}))})).catch((function(){throw e.mainImgLoaded=!1,new Error("Main image or mask not found")})));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t,e,i,n,r,o,a){return P.apply(this,arguments)}function P(){return(P=O(w().mark((function t(e,i,n,r,o,a,s){var c,l,u,m,d,h;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=e["".concat(n,"ImgUrl")],l=e["".concat(n,"ImgMaskUrl")],u="".concat(n,"Loaded"),m=e["".concat(n,"FullImageMask")],!e[u]){t.next=6;break}return t.abrupt("return");case 6:if(e[n]=new Image,m){t.next=11;break}return t.abrupt("return",I(c,l).then(function(){var t=O(w().mark((function t(r){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e[n].src=r,e[n].crossOrigin="anonymous",t.abrupt("return",new Promise((function(t,i){e[n].onload=t,e[n].onerror=i})).then((function(){e[u]=!0,S(e,i,a,s)})).catch((function(){e[u]=!1,S(e,i,a,s)})));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){throw e[u]=!1,new Error("Item image not found or image with mask could not be generated",u)})));case 11:return d=i[n.replace("item","")],h=e.enableRotation&&d?d.angle:0,t.abrupt("return",I(c,l,d,h,r,o).then(function(){var t=O(w().mark((function t(r){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e[n].src=r,e[n].crossOrigin="anonymous",t.abrupt("return",new Promise((function(t,i){e[n].onload=t,e[n].onerror=i})).then((function(){e[u]=!0,S(e,i,a,s)})).catch((function(){e[u]=!0,S(e,i,a,s)})));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){throw e[u]=!1,new Error("Item image not found or image with mask could not be generated",u)})));case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(t,e,i,n){E(t,e)&&(n(!1),i())}function E(t,e){var i=!0===t.mainImgLoaded;for(var n in e)i=i&&!0===t["item".concat(n,"Loaded")];return i}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function D(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?M(Object(i),!0).forEach((function(e){R(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):M(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function R(t,e,i){return(e=_(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function _(t){var e=function(t,e){if("object"!==A(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===A(e)?e:String(e)}i.r(e);var F=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};U(this,t),this.canvas=document.createElement("canvas"),this.wrapperEl=null,this.pixelDensity=window.devicePixelRatio>1?2:1,this.ctx=null,this.width=0,this.height=0,this.overlayType="item",this.overlayOpacity=1,this.xShiftPerPixel=0,this.yShiftPerPixel=0,this.zoom=1,this.loadingBlur=e.loadingBlur?e.loadingBlur:"5px",this.loadingGrayscale=e.loadingGrayscale?e.loadingGrayscale:"1",this.loadingOpacity=e.loadingOpacity?e.loadingOpacity:"0.8",this.autoScale=!0,this.combine=!1,this.mouseDownCallback=e.mouseDownCallback?e.mouseDownCallback:null,this.mouseUpCallback=e.mouseUpCallback?e.mouseUpCallback:null,this.mouseMoveCallback=e.mouseMoveCallback?e.mouseMoveCallback:null,this.images={mainImg:new Image,mainImgUrl:null,mainImgMask:null,mainImgOpacity:null,mainImgLayer:128,mainImgScale:1,mainImgLoaded:!1,mainImgDrawCallback:null,mainImgBrightness:!1,mainImgCoordinates:{x1:0,y1:0,x2:1,y2:1},mainImgAngle:0,enableRotation:!0,blockAspectRatio:!1},this.removedIds=[],this.staticIds=[],this.items=[],this.getRatio=function(){return(e.height||1250)/(e.width||2400)},this.init(e)}var e,i,n;return e=t,(i=[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.wrapperEl=e.el||document.getElementById(e.elId||"as_visualizer"),e.combine&&(this.combine=!0),!1===e.autoScale&&(this.autoScale=!1),this.wrapperEl&&(this.wrapperEl.appendChild(this.canvas),this.canvas.style.width="100%",this.ctx=this.canvas.getContext("2d"),!0===this.autoScale&&(this.rescale(),setInterval((function(){t.rescale()}),300),window.addEventListener("resize",this.rescale.bind(this))))}},{key:"rescale",value:function(){this.width===this.wrapperEl.clientWidth*this.pixelDensity&&this.canvas.width===this.width||(this.width=this.wrapperEl.clientWidth*this.pixelDensity,this.height=this.width*this.getRatio(),this.canvas.width=this.width,this.canvas.height=this.height,this.xShiftPerPixel=this.canvas.width>0?1/this.canvas.width:0,this.yShiftPerPixel=this.canvas.height>0?1/this.canvas.height:0,this.render())}},{key:"loadImagesAndRender",value:function(){var t=this;return new Promise((function(e,i){L(t.items,t.removedIds,t.images,t.width,t.height,t.render.bind(t),t.setLoading.bind(t),t.setRatio.bind(t)).then((function(){t.width=t.wrapperEl.clientWidth*t.pixelDensity,t.height=t.width*t.getRatio(),e()})).catch((function(){t.width=t.wrapperEl.clientWidth*t.pixelDensity,t.height=t.width*t.getRatio(),t.clear(),i()}))}))}},{key:"render",value:function(){var t=this;if(!this.images.mainImgLoaded)for(var e in this.items)if(!this.images["item".concat(e,"Loaded")])return;window.requestAnimationFrame((function(){v(t.items,t.removedIds,t.ctx,t.width,t.height,t.images,t.staticIds,t.overlayType,t.overlayOpacity,t.pixelDensity)}))}},{key:"setRatio",value:function(t,e){return this.width=0,this.height=0,this.getRatio=function(){return(e||1200)/(t||2300)},this.rescale.bind(this),this.render.bind(this),{width:t,height:e,ratio:this.getRatio()}}},{key:"setMainImg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a={url:t,coordinates:e,angle:i,drawCallback:n,brightness:r,opacity:o};if(this.images.mainImgUrl!==t)return null!==a.brightness&&"number"!=typeof a.brightness?(console.warn("Brightness configuration received is not a number"),a):(this.images.mainImgUrl=a.url,this.images.mainImgMask=null,this.images.mainImgOpacity=a.opacity,this.images.mainImgLoaded=!1,this.images.mainImgDrawCallback=a.drawCallback,this.images.mainImgBrightness=a.brightness,this.images.mainImgCoordinates=a.coordinates?a.coordinates:D({},this.images.mainImgCoordinates),this.images.mainImgAngle=a.angle,a)}},{key:"setMainImgWithMask",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s={url:t,mask:e,coordinates:i,angle:n,drawCallback:r,brightness:o,opacity:a};return null!==s.brightness&&"number"!=typeof s.brightness?(console.warn("Brightness configuration received is not a number"),s):(this.images.mainImgUrl=s.url,this.images.mainImgMask=s.mask,this.images.mainImgOpacity=s.opacity,this.images.mainImgLoaded=!1,this.images.mainImgDrawCallback=s.drawCallback,this.images.mainImgBrightness=s.brightness,this.images.mainImgCoordinates=s.coordinates?s.coordinates:D({},this.images.mainImgCoordinates),this.images.mainImgAngle=s.angle,s)}},{key:"getMainImg",value:function(){return this.images.mainImgUrl}},{key:"getMainImgMask",value:function(){return this.images.mainImgMask}},{key:"setMainImgScale",value:function(t){t>1||t<0||!t?console.error("Main image scale must be more than 0 and less or equals to 1"):this.images.mainImgScale!==t&&(this.images.mainImgScale=t,this.images.mainImgLoaded=!1)}},{key:"setMainImgCoordinates",value:function(t){var e={newCoordinates:t};return null==t.x1||null==t.y1||null==t.x2||null==t.y2?console.error("Coordinates not set. New coordinates requires 'x1', 'x2', 'y1' and 'y2'"):this.images.mainImgCoordinates={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},e}},{key:"setMainImgAngle",value:function(t){var e={newAngle:t};return"number"!=typeof t?console.error("Angle not set. New angle requires a number as value"):(this.images.enableRotation=!0,this.images.mainImgAngle=t),e}},{key:"setMainImgOpacity",value:function(t){this.images.mainImgOpacity=t}},{key:"setItem",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],l={url:t,coordinates:i,layer:n,angle:r,drawCallback:o,brightness:a,opacity:s,useAntialiasing:c,index:e};if(l.index&&this.images["item".concat(l.index,"ImgUrl")]&&this.images["item".concat(l.index,"ImgUrl")]===l.url)return console.warn("Image not changed"),this.images["item".concat(l.index,"Loaded")]=!1,this.items[l.index].drawCallback=l.drawCallback,this.items[l.index].brightness=l.brightness,this.items[l.index].opacity=l.opacity,l.coordinates&&this.setItemCoordinates(l.coordinates,l.index),l.layer&&this.setItemLayer(l.layer,l.index),l.angle&&this.setItemAngle(l.angle,l.index),l;if("number"==typeof l.index&&l.index>=0&&this.images["item".concat(l.index,"ImgUrl")])return this.images["item".concat(l.index,"ImgUrl")]=l.url,this.images["item".concat(l.index,"Loaded")]=!1,this.items[l.index].drawCallback=l.drawCallback,this.items[l.index].brightness=l.brightness,this.items[l.index].opacity=l.opacity,l.coordinates&&this.setItemCoordinates(l.coordinates,l.index),l.layer&&this.setItemLayer(l.layer,l.index),l.angle&&this.setItemAngle(l.angle,l.index),l;if(l.url){var u="number"==typeof e?e:this.getLastItemIndex();return l.index=u,this.images["item".concat(l.index)]=new Image,this.images["item".concat(l.index,"ImgUrl")]=l.url,this.images["item".concat(l.index,"ImgMaskUrl")]=null,this.images["item".concat(l.index,"FullImageMask")]=!1,this.images["item".concat(l.index,"Layer")]=l.index,this.images["item".concat(l.index,"Loaded")]=!1,this.items[l.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:l.drawCallback,brightness:l.brightness,opacity:l.opacity,useAntialiasing:l.useAntialiasing},i&&this.setItemCoordinates(i,l.index),l.layer&&this.setItemLayer(l.layer,l.index),l.angle&&this.setItemAngle(l.angle,l.index),l}console.warn("Item not added",l)}},{key:"setItemWithMask",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,u=arguments.length>10&&void 0!==arguments[10]&&arguments[10],m={url:t,mask:e,coordinates:n,layer:r,angle:o,drawCallback:a,useMaskOnFullImage:s,brightness:c,opacity:l,useAntialiasing:u,index:i};if(m.index&&this.images["item".concat(m.index,"ImgUrl")]&&this.images["item".concat(m.index,"ImgUrl")]===m.url)return console.warn("Image not changed"),this.images["item".concat(m.index,"Loaded")]=!1,this.images["item".concat(m.index,"ImgMaskUrl")]=m.mask,this.images["item".concat(m.index,"FullImageMask")]=m.useMaskOnFullImage,this.images["item".concat(m.index,"Loaded")]=!1,this.items[m.index].drawCallback=m.drawCallback,this.items[m.index].brightness=m.brightness,this.items[m.index].opacity=m.opacity,m.coordinates&&this.setItemCoordinates(m.coordinates,m.index),m.layer&&this.setItemLayer(m.layer,m.index),m.angle&&this.setItemAngle(m.angle,m.index),m;if("number"==typeof m.index&&m.index>=0&&this.images["item".concat(m.index,"ImgUrl")])return this.images["item".concat(m.index,"ImgUrl")]=m.url,this.images["item".concat(m.index,"ImgMaskUrl")]=m.mask,this.images["item".concat(m.index,"FullImageMask")]=m.useMaskOnFullImage,this.images["item".concat(m.index,"Loaded")]=!1,this.items[m.index].drawCallback=m.drawCallback,this.items[m.index].brightness=m.brightness,this.items[m.index].opacity=m.opacity,m.coordinates&&this.setItemCoordinates(m.coordinates,m.index),m.layer&&this.setItemLayer(m.layer,m.index),m.angle&&this.setItemAngle(m.angle,m.index),m;if(m.url){var d="number"==typeof m.index?m.index:this.getLastItemIndex();return m.index=d,this.images["item".concat(m.index)]=new Image,this.images["item".concat(m.index,"ImgUrl")]=m.url,this.images["item".concat(m.index,"ImgMaskUrl")]=m.mask,this.images["item".concat(m.index,"FullImageMask")]=m.useMaskOnFullImage,this.images["item".concat(m.index,"Layer")]=m.index,this.images["item".concat(m.index,"Loaded")]=!1,this.items[m.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:m.drawCallback,brightness:m.brightness,opacity:m.opacity,useAntialiasing:m.useAntialiasing},m.coordinates&&this.setItemCoordinates(m.coordinates,m.index),m.layer&&this.setItemLayer(m.layer,m.index),m.angle&&this.setItemAngle(m.angle,m.index),m}console.warn("Item not added",m)}},{key:"setItemImg",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a={url:t,drawCallback:i,brightness:n,opacity:r,useAntialiasing:o,index:e};if(a.index&&this.images["item".concat(a.index,"ImgUrl")]&&this.images["item".concat(a.index,"ImgUrl")]===a.url)return console.warn("Image not changed"),this.images["item".concat(a.index,"Loaded")]=!1,this.items[a.index].drawCallback=a.drawCallback,this.items[a.index].brightness=a.brightness,this.items[a.index].opacity=a.opacity,a;if("number"==typeof a.index&&a.index>=0&&this.images["item".concat(a.index,"ImgUrl")])return this.images["item".concat(a.index,"ImgUrl")]=a.url,this.images["item".concat(a.index,"Loaded")]=!1,this.items[a.index].drawCallback=a.drawCallback,this.items[a.index].brightness=a.brightness,this.items[a.index].opacity=a.opacity,a;if(t){var s="number"==typeof e?e:this.getLastItemIndex();return a.index=s,this.images["item".concat(a.index)]=new Image,this.images["item".concat(a.index,"ImgUrl")]=a.url,this.images["item".concat(a.index,"ImgMaskUrl")]=null,this.images["item".concat(a.index,"Layer")]=a.index,this.images["item".concat(a.index,"Loaded")]=!1,this.items[a.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:a.drawCallback,brightness:a.brightness,opacity:a.opacity,useAntialiasing:a.useAntialiasing},a}console.warn("Item not added",a)}},{key:"removeItem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e={index:t};this.images["item".concat(e.index,"ImgUrl")]||console.error("Item with index ".concat(e.index," not found"));var i=this.images["item".concat(e.index,"ImgUrl")],n=this.images["item".concat(e.index,"ImgMaskUrl")],r=this.images["item".concat(e.index,"FullImageMask")],o=this.images["item".concat(e.index,"Layer")],a=this.items[e.index];return this.removedIds.push(e.index),{url:i,mask:n,useMaskOnFullImage:r,layer:o,index:e.index,item:a}}},{key:"setItemLayer",value:function(t,e){var i={layer:t,index:e};return"number"!=typeof e?console.error("Layer not set. Index value required"):0===Math.round(t)||t>this.images.mainImgLayer?console.error("Layer not set. Layer for ITEM ".concat(e," should be more or less than 0, and not more than ").concat(this.images.mainImgLayer)):this.images["item".concat(e)]&&this.images["item".concat(e,"ImgUrl")]?(this.images["item".concat(e,"Loaded")]=!1,this.images["item".concat(e,"Layer")]=t):console.error("Layer not set. Item doesn't exists with this index ".concat(e)),i}},{key:"setItemCoordinates",value:function(t,e){var i={newCoordinates:t,index:e};return"number"!=typeof e?console.error("Coordinates not set. Index value required"):null==t.x1||null==t.y1||null==t.x2||null==t.y2?console.error("Coordinates not set. New coordinates requires 'x1', 'x2', 'y1' and 'y2'"):this.images["item".concat(e)]&&this.images["item".concat(e,"ImgUrl")]?(this.items[e].coordinates={x1:+t.x1,y1:+t.y1,x2:+t.x2,y2:+t.y2},this.items[e].originalCoordinates.length||(this.items[e].originalCoordinates={x1:+t.x1,y1:+t.y1,x2:+t.x2,y2:+t.y2})):console.error("Coordinates not set. Item doesn't exists with this index ".concat(e)),i}},{key:"setItemOpacity",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,n={opacity:e,index:i};return"number"!=typeof n.index?console.error("Opacity not set. Index value required"):"number"!=typeof n.opacity?console.error("Opacity not set. New opacity requires a number as value"):this.images["item".concat(n.index)]&&this.images["item".concat(n.index,"ImgUrl")]?(this.items[i].opacity=n.opacity,this.items[i].linkedItems.forEach((function(e){t.items[e].opacity=n.opacity}))):console.error("Opacity not set. Item doesn't exists with this index ".concat(n.index)),n}},{key:"setItemAngle",value:function(t,e){var i=this,n={angle:t,index:e};return"number"!=typeof e?console.error("Angle not set. Index value required"):"number"!=typeof t?console.error("Angle not set. New angle requires a number as value"):this.images["item".concat(e)]&&this.images["item".concat(e,"ImgUrl")]?(this.images.enableRotation=!0,0===this.items[e].angle&&0===this.items[e].originalAngle&&0!=t&&(this.items[e].originalAngle=t),this.items[e].angle=n.angle,this.items[e].linkedItems.forEach((function(t){var e=i.items[t].originalAngle;i.items[t].angle=i.items[t].useBaseItemCoordinatesAsReference?n.angle+e:n.angle}))):console.error("Angle not set. Item doesn't exists with this index ".concat(e)),n}},{key:"setItemScale",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e<0)console.error("Scale value must be more than 0");else{if(e>=0&&i>=0){var o=!1,a=D({},this.items[i].coordinates),l=(1-e)*(a.x2-a.x1)*-.25,u=(1-e)*(a.y2-a.y1)*-.25;return"x"!==r&&(this.items[i].coordinates.x1=a.x1-("left"===n?0:"right"===n?2*l:l)),"x"!==r&&(this.items[i].coordinates.x2=a.x2+("right"===n?0:"left"===n?2*l:l)),"y"!==r&&(this.items[i].coordinates.y1=a.y1-("top"===n?0:"bottom"===n?2*u:u)),"y"!==r&&(this.items[i].coordinates.y2=a.y2+("bottom"===n?0:"top"===n?2*u:u)),this.items[i].linkedItems.forEach((function(l){if(!0===t.items[l].useBaseItemCoordinatesAsReference)t.items[l].coordinates=s(t.items[i].coordinates,c(a,t.items[l].coordinates));else{var u=D({},t.items[l].coordinates),m=(1-e)*(u.x2-u.x1)*-.25,d=(1-e)*(u.y2-u.y1)*-.25;"x"!==r&&(t.items[l].coordinates.x1=t.items[l].coordinates.x1-("left"===n?0:"right"===n?2*m:m)),"x"!==r&&(t.items[l].coordinates.x2=t.items[l].coordinates.x2+("right"===n?0:"left"===n?2*m:m)),"y"!==r&&(t.items[l].coordinates.y1=t.items[l].coordinates.y1-("top"===n?0:"bottom"===n?2*d:d)),"y"!==r&&(t.items[l].coordinates.y2=t.items[l].coordinates.y2+("bottom"===n?0:"top"===n?2*d:d))}o=!0})),{item:this.items[i],scale:e,oldCoordinates:a,newCoordinates:this.items[i].coordinates,affectedLinkedItems:o}}console.error("Scale must be more than 0 or Item index is not set")}}},{key:"setItemLink",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===t||null===e?console.error("Base item index or linked item index is not set"):void 0===this.items[e]||void 0===this.items[t]?console.error("Items with index ".concat(e," or ").concat(t," doesn't exist")):i&&!this.items[t].coordinates?console.error("Base item with index ".concat(t," doesn't have coordinates set")):i&&!this.items[e].coordinates?console.error("Linked item with index ".concat(e," doesn't have coordinates set")):this.images["item".concat(t)]&&this.items[t]?this.images["item".concat(e)]?(this.items[t].linkedItems.push(e),i&&(this.items[e].coordinates=D({},s(this.items[t].coordinates,this.items[e].coordinates)),this.items[e].useBaseItemCoordinatesAsReference=!0)):console.error("Linked item with index ".concat(e," not found")):console.error("Base item with index ".concat(t," not found")),{baseItemIndex:t,linkedItemIndex:e,useBaseItemCoordinatesAsReference:i}}},{key:"setItemUnlink",value:function(t,e){if(this.images["item".concat(t)]&&this.items[t])if(this.images["item".concat(e)]){var i=this.items[t].linkedItems.indexOf(e);delete this.items[t].linkedItems[i]}else console.error("Linked item with index ".concat(e," not found"));else console.error("Base item with index ".concat(t," not found"));return{baseItemIndex:t,linkedItemIndex:e}}},{key:"setItemAntialiasing",value:function(t,e){var i={useAntialiasing:t,index:e};return"number"!=typeof e?console.error("Antialiasing not set. Index value required"):"boolean"!=typeof t?console.error("Antialiasing not set. New antialiasing requires a boolean as value"):(this.images["item".concat(e,"Loaded")]=!1,this.items[e].useAntialiasing=i.useAntialiasing),i}},{key:"setItemAngles",value:function(t){var e={newAngle:t,affectedIds:[]},i=this.getBlockedItemIds();for(var n in this.items)i.includes(parseInt(n))||(this.images.enableRotation=!0,0===this.items[n].angle&&0===this.items[n].originalAngle&&0!=t&&(this.items[n].originalAngle=t),this.items[n].angle=t,e.affectedIds.push(n));return e}},{key:"setZoom",value:function(t){t<1||t>4||(this.zoom=t,this.canvas.style.width=Math.round(1e3*this.zoom)/10+"%",this.wrapperEl.scrollLeft=(this.wrapperEl.scrollWidth-this.wrapperEl.offsetWidth)/2)}},{key:"setLoading",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?(this.wrapperEl.style.transition="filter .33s, opacity .33s",this.wrapperEl.style.filter="blur(".concat(this.loadingBlur,") grayscale(").concat(this.loadingGrayscale,")"),this.wrapperEl.style.opacity="".concat(this.loadingOpacity)):(this.wrapperEl.style.filter="",this.wrapperEl.style.opacity="1")}},{key:"getLastItemIndex",value:function(){return this.items.length}},{key:"getFirstItemLayer",value:function(){var t=this,e=0;return Object.keys(this.images).forEach((function(i){i.includes("Layer")&&i.includes("item")&&t.images[i]<e&&(e=t.images[i])})),e}},{key:"getBlockedItemIds",value:function(){var t=this.staticIds.slice();for(var e in this.items)r(this.images["item".concat(e)].src)||t.push(e);return t}},{key:"getUtils",value:function(){return{drawImageLeftHalf:o,drawImageRightHalf:a,validateSrc:r,getLinkedItemCoordinatesFromBaseItem:s,getOriginalCoordinatesFromLinkedItemWithBaseItem:c,getPercentByUnit:u,scaleCoordinates:l,createCanvasWithBlurredImage:m}}},{key:"resizeToOriginalProportion",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=e||this.combine){this.combine&&null==e&&(e=0);var n=!1,r=i?this.images["item".concat(e)].naturalWidth/this.images["item".concat(e)].naturalHeight:this.images["item".concat(e)].naturalHeight/this.images["item".concat(e)].naturalWidth;if(this.combine)for(var o in this.items)this.getBlockedItemIds().includes(parseInt(o))||(i?this.items[o].coordinates.x2=r*(this.items[e].coordinates.y2-this.items[e].coordinates.y1)*this.height/this.width+this.items[e].coordinates.x1:this.items[o].coordinates.y2=r*(this.items[e].coordinates.x2-this.items[e].coordinates.x1)*this.width/this.height+this.items[e].coordinates.y1);else{var a=D({},this.items[e].coordinates);i?this.items[e].coordinates.x2=r*(this.items[e].coordinates.y2-this.items[e].coordinates.y1)*this.height/this.width+this.items[e].coordinates.x1:this.items[e].coordinates.y2=r*(this.items[e].coordinates.x2-this.items[e].coordinates.x1)*this.width/this.height+this.items[e].coordinates.y1,this.items[e].linkedItems.forEach((function(r){if(t.items[r].useBaseItemCoordinatesAsReference)t.items[r].coordinates=s(t.items[e].coordinates,c(a,t.items[r].coordinates));else{var o=i?t.images["item".concat(r)].naturalWidth/t.images["item".concat(r)].naturalHeight:t.images["item".concat(r)].naturalHeight/t.images["item".concat(r)].naturalWidth;i?t.items[r].coordinates.x2=o*(t.items[r].coordinates.y2-t.items[r].coordinates.y1)*t.height/t.width+t.items[r].coordinates.x1:t.items[r].coordinates.y2=o*(t.items[r].coordinates.x2-t.items[r].coordinates.x1)*t.width/t.height+t.items[r].coordinates.y1}n=!0}))}return{item:this.items[e],index:e,horizontal:i,affectedLinkedItems:n}}console.error("Item index not set. Index is required if 'Combine' option is not set to the visualizer")}},{key:"download",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image.png",e=document.createElement("a");e.download=t,e.href=this.canvas.toDataURL(),e.click()}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ctx.clearRect(0,0,this.width,this.height),t&&this.reset()}},{key:"reset",value:function(){var t=D({},this.images);this.staticIds=[],this.items=[],this.images={mainImg:new Image,mainImgUrl:null,mainImgMask:null,mainImgOpacity:null,mainImgScale:1,mainImgLoaded:!1,mainImgDrawCallback:null,mainImgBrightness:!1,mainImgCoordinates:{x1:0,y1:0,x2:1,y2:1},mainImgAngle:0,mainImgLayer:128,enableRotation:t.enableRotation},this.zoom=1,this.overlayOpacity=1}},{key:"resetItems",value:function(){var t=D({},this.images);this.staticIds=[],this.items=[],this.images={mainImg:t.mainImg,mainImgUrl:t.mainImgUrl,mainImgMask:t.mainImgMask,mainImgOpacity:t.mainImgOpacity,mainImgScale:t.mainImgScale,mainImgLoaded:t.mainImgLoaded,mainImgDrawCallback:t.mainImgDrawCallback,mainImgBrightness:t.mainImgBrightness,mainImgCoordinates:t.mainImgCoordinates,mainImgAngle:t.mainImgAngle,mainImgLayer:t.mainImgLayer,enableRotation:t.enableRotation}}}])&&B(e.prototype,i),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.default=F},function(t,e,i){"use strict";i.r(e);var n=i(0);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach((function(e){s(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===r(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function c(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=u(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function l(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return m(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function d(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1-s,l=n*r.coordinates.y1-s,u=i*r.coordinates.x1+s,m=n*r.coordinates.y1+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function h(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x2-s,l=n*r.coordinates.y1-s,u=i*r.coordinates.x2+s,m=n*r.coordinates.y1+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function g(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x2-s,l=n*r.coordinates.y2-s,u=i*r.coordinates.x2+s,m=n*r.coordinates.y2+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function f(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1-s,l=n*r.coordinates.y2-s,u=i*r.coordinates.x1+s,m=n*r.coordinates.y2+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function y(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1+s,l=n*r.coordinates.y1-s,u=i*r.coordinates.x2-s,m=n*r.coordinates.y1+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function p(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1+s,l=n*r.coordinates.y2-s,u=i*r.coordinates.x2-s,m=n*r.coordinates.y2+s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function v(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1-s,l=n*r.coordinates.y1+s,u=i*r.coordinates.x1+s,m=n*r.coordinates.y2-s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function b(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x2-s,l=n*r.coordinates.y1+s,u=i*r.coordinates.x2+s,m=n*r.coordinates.y2-s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function I(t,e,i,n,r,o,a){var s=5*o,c=i*r.coordinates.x1+s,l=n*r.coordinates.y1+s,u=i*r.coordinates.x2-s,m=n*r.coordinates.y2-s;return t/a>=c&&t/a<=u&&e/a>=l&&e/a<=m}function x(t,e,i,n,r,o,a,s){return d(t,e,i,n,r,o,a)?"cursor-nw-resize":h(t,e,i,n,r,o,a)?"cursor-ne-resize":g(t,e,i,n,r,o,a)?"cursor-nw-resize":f(t,e,i,n,r,o,a)?"cursor-ne-resize":!s&&y(t,e,i,n,r,o,a)?"cursor-n-resize":!s&&p(t,e,i,n,r,o,a)?"cursor-s-resize":!s&&v(t,e,i,n,r,o,a)?"cursor-w-resize":!s&&b(t,e,i,n,r,o,a)?"cursor-e-resize":I(t,e,i,n,r,o,a)?"cursor-move":null}function w(t,e,i,n,r,o,s,c,l){return d(t,e,i,n,r,s,c)?{itemId:o,area:"top-left",startX:t,startY:e,coordinates:a({},r.coordinates)}:h(t,e,i,n,r,s,c)?{itemId:o,area:"top-right",startX:t,startY:e,coordinates:a({},r.coordinates)}:g(t,e,i,n,r,s,c)?{itemId:o,area:"bottom-right",startX:t,startY:e,coordinates:a({},r.coordinates)}:f(t,e,i,n,r,s,c)?{itemId:o,area:"bottom-left",startX:t,startY:e,coordinates:a({},r.coordinates)}:!l&&y(t,e,i,n,r,s,c)?{itemId:o,area:"top",startX:t,startY:e,coordinates:a({},r.coordinates)}:!l&&p(t,e,i,n,r,s,c)?{itemId:o,area:"bottom",startX:t,startY:e,coordinates:a({},r.coordinates)}:!l&&v(t,e,i,n,r,s,c)?{itemId:o,area:"left",startX:t,startY:e,coordinates:a({},r.coordinates)}:!l&&b(t,e,i,n,r,s,c)?{itemId:o,area:"right",startX:t,startY:e,coordinates:a({},r.coordinates)}:I(t,e,i,n,r,s,c)?{itemId:o,area:"inside",startX:t,startY:e,coordinates:a({},r.coordinates)}:null}function k(t,e,i){var n=e.getBoundingClientRect();return{x:Math.round((t.clientX-n.left)*i),y:Math.round((t.clientY-n.top)*i)}}function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function j(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?L(Object(i),!0).forEach((function(e){C(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):L(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function C(t,e,i){return(e=function(t){var e=function(t,e){if("object"!==O(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===O(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function P(t,e,i,n,r,o,a,s,c){var l,u=e.coordinates.x1-(e.startX-r.x)*o/s,m=e.coordinates.x2-(e.startX-r.x)*o/s,d=e.coordinates.y1-(e.startY-r.y)*a/s,h=e.coordinates.y2-(e.startY-r.y)*a/s,g=j({},null===(l=t[e.itemId])||void 0===l?void 0:l.coordinates);return 0!=c&&e.startX!=r.x&&("bottom-right"===e.area?h=c*(m-t[e.itemId].coordinates.x1)*i/n+t[e.itemId].coordinates.y1:"bottom-left"===e.area?h=c*(t[e.itemId].coordinates.x2-u)*i/n+t[e.itemId].coordinates.y1:"top-right"===e.area?d=-c*(m-t[e.itemId].coordinates.x1)*i/n+t[e.itemId].coordinates.y2:"top-left"===e.area&&(d=-c*(t[e.itemId].coordinates.x2-u)*i/n+t[e.itemId].coordinates.y2)),"top-left"===e.area?(t[e.itemId].coordinates.x1=u,t[e.itemId].coordinates.y1=d):"top-right"===e.area?(t[e.itemId].coordinates.x2=m,t[e.itemId].coordinates.y1=d):"bottom-right"===e.area?(t[e.itemId].coordinates.x2=m,t[e.itemId].coordinates.y2=h):"bottom-left"===e.area?(t[e.itemId].coordinates.x1=u,t[e.itemId].coordinates.y2=h):"top"===e.area?t[e.itemId].coordinates.y1=d:"bottom"===e.area?t[e.itemId].coordinates.y2=h:"left"===e.area?t[e.itemId].coordinates.x1=u:"right"===e.area?t[e.itemId].coordinates.x2=m:"inside"===e.area&&(t[e.itemId].coordinates.x1=u,t[e.itemId].coordinates.x2=m,t[e.itemId].coordinates.y1=d,t[e.itemId].coordinates.y2=h),t[e.itemId].linkedItems.length>0&&t[e.itemId].linkedItems.forEach((function(i){var n,r=j({},null===(n=t[i])||void 0===n?void 0:n.coordinates),o=t[e.itemId].coordinates,a=g.x2-g.x1,s=g.y2-g.y1,c=o.x2-o.x1,l=o.y2-o.y1,f=c*(Math.abs(g.x1-r.x1)/a),y=c*(Math.abs(g.x2-r.x2)/a),p=l*(Math.abs(g.y1-r.y1)/s),v=l*(Math.abs(g.y2-r.y2)/s);"inside"===e.area?(t[i].coordinates.x1=u-g.x1+r.x1,t[i].coordinates.x2=m-g.x2+r.x2,t[i].coordinates.y1=d-g.y1+r.y1,t[i].coordinates.y2=h-g.y2+r.y2):(t[i].coordinates.x1=r.x1>g.x1?f+o.x1:o.x1-f,t[i].coordinates.x2=r.x2>g.x2?y+o.x2:o.x2-y,t[i].coordinates.y1=r.y1>g.y1?p+o.y1:o.y1-p,t[i].coordinates.y2=r.y2>g.y2?v+o.y2:o.y2-v)})),t}function S(t,e,i,n,r,o,a,s,u,m,d,h,g,f,y){var p=k(t,r,d);o.classList.remove("cursor-n-resize","cursor-s-resize","cursor-nw-resize","cursor-ne-resize","cursor-e-resize","cursor-w-resize","cursor-move","cursor-rotate");var v=function(t,e,i,n,r,o,a,s,u){var m=Object.keys(o).sort((function(t,e){return parseInt(r["item".concat(t,"Layer")])-parseInt(r["item".concat(e,"Layer")])})).reverse().map((function(t){return parseInt(t)})),d=[];if(o.forEach((function(t){d.push.apply(d,l(t.linkedItems))})),u.length>0){var h,g=c(m);try{for(g.s();!(h=g.n()).done;){var f=h.value;if(!u.includes(parseInt(f))&&!d.includes(f)){var y=x(t,e,i,n,o[f],a,s,r.blockAspectRatio);if(y)return y}}}catch(t){g.e(t)}finally{g.f()}return null}var p,v=c(m);try{for(v.s();!(p=v.n()).done;){var b=p.value;if(!d.includes(b)){var I=x(t,e,i,n,o[b],a,s,r.blockAspectRatio);if(I)return I}}}catch(t){v.e(t)}finally{v.f()}return null}(p.x,p.y,a,s,e,i,d,h,f);if(null!==v&&o.classList.add(v),null!==n&&null!==n.itemId&&n.area){var b=(i[n.itemId].coordinates.y2-i[n.itemId].coordinates.y1)*s/((i[n.itemId].coordinates.x2-i[n.itemId].coordinates.x1)*a);y?Object.keys(i).forEach((function(t){f.includes(parseInt(t))||(n.itemId=t,i=P(i,n,a,s,p,u,m,h,b))})):i=P(i,n,a,s,p,u,m,h,b)}null!==n&&null!==n.itemId&&n.area&&window.requestAnimationFrame(g)}function E(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function D(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?M(Object(i),!0).forEach((function(e){R(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):M(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function R(t,e,i){return(e=_(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function _(t){var e=function(t,e){if("object"!==A(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!==A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===A(e)?e:String(e)}function F(t,e){return(F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=N(t);if(e){var r=N(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T(this,i)}}function T(t,e){if(e&&("object"===A(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t){var e=k(t,this.canvas,this.pixelDensity);this.editData=function(t,e,i,n,r,o,a,s,u,m){var d=Object.keys(o).filter((function(t){return!a.includes(t)})).sort((function(t,e){return parseInt(r["item".concat(t,"Layer")])-parseInt(r["item".concat(e,"Layer")])})).reverse().map((function(t){return parseInt(t)})),h=[];if(o.forEach((function(t){h.push.apply(h,l(t.linkedItems))})),m.length>0){var g,f=c(d);try{for(f.s();!(g=f.n()).done;){var y=g.value;if(!m.includes(y)&&!h.includes(y)){var p=w(t,e,i,n,o[y],y,s,u,r.blockAspectRatio);if(p)return p}}}catch(t){f.e(t)}finally{f.f()}return{itemId:null}}var v,b=c(d);try{for(b.s();!(v=b.n()).done;){var I=v.value;if(!h.includes(I)){var x=w(t,e,i,n,o[I],I,s,u,r.blockAspectRatio);if(x)return x}}}catch(t){b.e(t)}finally{b.f()}return{itemId:null}}(e.x,e.y,this.width,this.height,this.images,this.items,this.removedIds,this.pixelDensity,this.zoom,this.getBlockedItemIds()),null!==this.mouseDownCallback&&this.mouseDownCallback(this.items[this.editData.itemId])}function q(){this.editData={itemId:null},function(t){for(var e in t)t[e].coordinates.x1>t[e].coordinates.x2&&E(t[e].coordinates,"x1","x2"),t[e].coordinates.y1>t[e].coordinates.y2&&E(t[e].coordinates,"y1","y2")}(this.items),null!==this.mouseUpCallback&&this.mouseUpCallback(this.items[this.editData.itemId])}function Y(t){var e,i=this;if(null!=(null===(e=this.editData)||void 0===e?void 0:e.itemId)){var n=Object.keys(this.images).filter((function(t){return t.includes("FullImageMask")&&i.images[t]}));(null==n?void 0:n.length)>0&&(n.forEach((function(t){i.images[t.replace("FullImageMask","Loaded")]=!1})),this.loadImagesAndRender())}S(t,this.images,this.items,this.editData,this.canvas,this.wrapperEl,this.width,this.height,this.xShiftPerPixel,this.yShiftPerPixel,this.pixelDensity,this.zoom,this.render.bind(this),this.getBlockedItemIds(),this.combine),null!==this.mouseMoveCallback&&this.mouseMoveCallback(this.items[this.editData.itemId])}var X=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(o,t);var e,i,n,r=z(o);function o(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return U(this,o),(t=r.call(this,e)).editData={itemId:null},t}return e=o,(i=[{key:"enableEditing",value:function(){this.canvas.addEventListener("mousedown",W.bind(this)),this.canvas.addEventListener("mouseup",q.bind(this)),this.canvas.addEventListener("mousemove",Y.bind(this))}},{key:"disableEditing",value:function(){this.canvas.removeEventListener("mousedown",W.bind(this)),this.canvas.removeEventListener("mouseup",q.bind(this)),this.canvas.removeEventListener("mousemove",Y.bind(this))}},{key:"blockAspectRatioDistortion",value:function(t){this.images.blockAspectRatio=t}},{key:"setOverlayType",value:function(t){this.overlayType=t}},{key:"setOverlayOpacity",value:function(t){this.overlayOpacity=t}},{key:"setStaticItemsId",value:function(t){return this.staticIds=null!=t?t:[],this.staticIds}},{key:"getCoordinates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(t){for(var e={},i=0;i<this.items.length;i++)if(void 0!==this.items[i]){var n=this.items[i];e["".concat(i)]=D({},n.coordinates)}return D(D({},e),{},{mainImg:D({},this.images.mainImgCoordinates)})}var r=[];return this.items.forEach((function(t){return r.push(D({},t.coordinates))})),r}},{key:"getAngles",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){for(var i={},n=0;n<this.items.length;n++)if(void 0!==this.items[n]){var r=this.items[n];i["".concat(n)]=!1===this.images.enableRotation?0:r.angle}return D(D({},i),{},{mainImg:!1===this.images.enableRotation?0:this.images.mainImgAngle})}var o=[];return this.items.forEach((function(e){return o.push(!1===t.images.enableRotation?0:e.angle)})),o}},{key:"coordinatesChanged",value:function(){for(var t in this.items)for(var e=0,i=["x1","y1","x2","y2"];e<i.length;e++){var n=i[e];if(void 0!==this.items[t]&&!(this.items[t].coordinates[n]==this.items[t].originalCoordinates[n]||isNaN(this.items[t].coordinates[n])&&isNaN(this.items[t].originalCoordinates[n])))return!0}return!1}},{key:"anglesChanged",value:function(){for(var t in this.items)if(this.items[t].angle!=this.items[t].originalAngle)return!0;return!1}}])&&B(e.prototype,i),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(n.default);e.default=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new X(t);return null!=t&&t.editor&&e.enableEditing(),e}},function(t,e,i){t.exports=i(3)},function(t,e,i){"use strict";i.r(e);var n=i(1);window.initASCanvas=n.default}]);