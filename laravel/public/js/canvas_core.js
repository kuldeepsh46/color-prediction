/*! For license information please see canvas_core.js.LICENSE.txt */
!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=4)}([function(e,t,i){"use strict";function n(e,t,i){return{width:t*(e.coordinates.x2-e.coordinates.x1),height:i*(e.coordinates.y2-e.coordinates.y1),x:t*e.coordinates.x1,y:i*e.coordinates.y1}}function a(e){return""!=e&&e!=location.href&&e!=location.origin&&e!=location.origin+"/"}function r(e,t,i,n,a,r,o,s){e.drawImage(t,0,0,o/2,s,i,n,a/2,r)}function o(e,t,i,n,a,r,o,s){e.drawImage(t,o/2,0,o/2,s,i+a/2,n,a/2,r)}function s(e,t){var i=e.x2-e.x1,n=e.y2-e.y1,a={x1:0,x2:0,y1:0,y2:0};return a.x1=e.x1+i*t.x1,a.x2=e.x1+i*t.x2,a.y1=e.y1+n*t.y1,a.y2=e.y1+n*t.y2,a}function l(e,t){var i=e.x2-e.x1,n=e.y2-e.y1,a={x1:0,x2:0,y1:0,y2:0};return a.x1=(t.x1-e.x1)/i,a.x2=(t.x2-e.x1)/i,a.y1=(t.y1-e.y1)/n,a.y2=(t.y2-e.y1)/n,a}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=[],r=(1-t)*(e.x2-e.x1)*-.25*i,o=(1-t)*(e.y2-e.y1)*-.25*n;return a.x1=e.x1-r,a.x2=e.x2+r,a.y1=e.y1-o,a.y2=e.y2+o,a}function m(e,t,i){try{return(t-e)/i}catch(e){return 0}}function h(e,t,i){var n=document.createElement("canvas"),a=n.getContext("2d");n.width=e.width,n.height=e.height;var r=Math.round(e.width/t/i*100*.618)/100;return r>.33&&(a.filter="blur(".concat(r,"px)")),a.drawImage(e,0,0),n}function u(e,t,i,a,r,o,s,l,c){e.opacity||(i.globalAlpha=o),function(e,t,i,a,r,o,s){if(!function(e){return e.naturalWidth>0}(r))return;var l=n(e,i,a);!function(e,t,i,n,a,r,o,s,l,c,m,u){var d=c?h(o,a,u):o,g=t*Math.PI/180,f=i+a/2,y=n+r/2,p=-a/2,v=-r/2;e.save(),e.translate(f,y),e.rotate(g),null!==l&&(e.filter="brightness(".concat(l,"%)"));null!=m&&m<1&&(e.globalAlpha=m);s?s(e,d,p,v,a,r,o.naturalWidth,o.naturalHeight):e.drawImage(d,p,v,a,r);e.restore()}(t,o,l.x,l.y,l.width,l.height,r,e.drawCallback,e.brightness,e.useAntialiasing,e.opacity,s)}(e,i,a,r,s[t],l,c),i.globalAlpha=1}function d(e,t,i,a,r){t.fillStyle="rgba(255, 50, 50, "+r+")",e.opacity||(t.globalAlpha=r),function(e,t,i,a,r){var o=n(e,i,a);null!=r&&r<1&&(t.globalAlpha=r);t.fillRect(Math.round(o.x),Math.round(o.y),Math.round(o.width),Math.round(o.height))}(e,t,i,a,e.opacity),t.globalAlpha=1}function g(e,t,i,a,r,o){t.strokeStyle="rgba(180, 255, 180, "+r+")",t.lineWidth=o,function(e,t,i,a){var r=n(e,i,a);t.save(),t.translate(Math.round(r.x)+Math.round(r.width)/2,Math.round(r.y)+Math.round(r.height)/2),t.strokeRect(-Math.round(r.width)/2,-Math.round(r.height)/2,Math.round(r.width)-2,Math.round(r.height)-2),t.restore()}(e,t,i,a)}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function p(e,t,i){return(t=function(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===f(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function v(e,t,i,n,r,o,s,l,c,m){i.clearRect(0,0,n,r);var h=e.map((function(e){return e.linkedItems})).filter((function(e){return e.length>0})).flat(),f=n*o.mainImgScale||n,y=r*o.mainImgScale||r;if("item"===l||"itemWithFrame"===l){var p=function(e,t){var i={},n=[],a=[];for(var r in t.forEach((function(t,a){if(null!==e["item".concat(a,"Layer")]){var r=e["item".concat(a,"Layer")],o=r+(r>=0?1:0)+e.mainImgLayer;i[o]="item".concat(a),n.includes(o)?console.error("Layer already taked by other item","Layer: ",o,"Item: ",a):n.push(o)}else console.error("Set Layer for Item".concat(a,". Current value is NULL"))})),i[e.mainImgLayer]="mainImg",i)a.push(i[r]);return a}(o,e);!function e(t,i,n,r,o,s,l,c,m,h,d,g){if(h.includes(parseInt(t[i].replace("item",""))))return void(i<t.length-1&&e(t,i+1,n,r,o,s,l,c,m,h,d,g));var f=t[i],y="mainImg"!=f?m[parseInt(f.replace("item",""))]:null,p=c.enableRotation&&y?y.angle:0;"mainImg"===f?(x(n,r,o,s,l,c,d,g),i<t.length-1&&e(t,i+1,n,r,o,s,l,c,m,h,d,g)):c["".concat(f,"FullImageMask")]?(n.drawImage(c[f],(r-s)/2,(o-l)/2,s,l),i<t.length-1&&e(t,i+1,n,r,o,s,l,c,m,h,d,g)):a(c[f].src)&&(u(y,f,n,r,o,d,c,p,g),i<t.length-1&&e(t,i+1,n,r,o,s,l,c,m,h,d,g))}(p,0,i,n,r,f,y,o,e,t,c,m),"itemWithFrame"===l&&p.forEach((function(a){if(!t.includes(parseInt(a.replace("item","")))&&"mainImg"!=a){var l=parseInt(a.replace("item","")),u=e[l];!1===o.enableRotation||u.angle;s.includes(l)||h.includes(l)||g(u,i,n,r,c,m)}}))}else x(i,n,r,f,y,o,c,m),e.forEach((function(e,t){"rect"===l?a(o["item".concat(t)].src)&&d(e,i,n,r,c):"frame"===l&&a(o["item".concat(t)].src)&&g(e,i,n,r,c,m)}))}function x(e,t,i,n,r,o,s,l){if(a(o.mainImg.src)){var c=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?y(Object(i),!0).forEach((function(t){p(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):y(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},o.mainImgCoordinates);1!==o.mainImgScale&&(c.x1=(t-n)/2/t,c.y1=(i-r)/2/i,c.x2=((t-n)/2+n)/t,c.y2=((i-r)/2+r)/i),u({coordinates:c,drawCallback:o.mainImgDrawCallback,brightness:o.mainImgBrightness,opacity:o.mainImgOpacity},"mainImg",e,t,i,s,o,o.mainImgAngle,l)}}function I(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!t)return new Promise((function(t,i){return t(e)}));var s=document.createElement("canvas"),l=s.getContext("2d"),c=new Image;return c.crossOrigin="anonymous",c.src=t,new Promise((function(t,m){c.onload=function(){var h=o||c.naturalHeight,u=r||c.naturalWidth;s.width=u,s.height=h;var d=new Image;d.crossOrigin="anonymous",d.src=e,d.onload=function(){if(l.globalCompositeOperation="destination-over",l.drawImage(c,0,0,u,h),i){var e=n(i,u,h),r=a*Math.PI/180,o=e.x+e.width/2,m=e.y+e.height/2,g=-e.width/2,f=-e.height/2;r&&null!=o&&null!=m&&(l.save(),l.translate(o,m),l.rotate(r)),l.globalCompositeOperation="source-in",i.drawCallback?i.drawCallback(l,d,g,f,e.width,e.height):l.drawImage(d,g,f,e.width,e.height),r&&null!=o&&null!=m&&l.restore()}else l.globalCompositeOperation="source-out",l.drawImage(d,0,0,u,h);t(s.toDataURL("webp"))},d.onerror=function(){m("Image not found")}},c.onerror=function(){m("Mask image not found")}}))}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(){w=function(){return t};var e,t={},i=Object.prototype,n=i.hasOwnProperty,a=Object.defineProperty||function(e,t,i){e[t]=i.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,i){return e[t]=i}}function m(e,t,i,n){var r=t&&t.prototype instanceof y?t:y,o=Object.create(r.prototype),s=new P(n||[]);return a(o,"_invoke",{value:M(e,i,s)}),o}function h(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=m;var u="suspendedStart",d="executing",g="completed",f={};function y(){}function p(){}function v(){}var x={};c(x,o,(function(){return this}));var I=Object.getPrototypeOf,k=I&&I(I(j([])));k&&k!==i&&n.call(k,o)&&(x=k);var L=v.prototype=y.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function i(a,r,o,s){var l=h(e[a],e,r);if("throw"!==l.type){var c=l.arg,m=c.value;return m&&"object"==b(m)&&n.call(m,"__await")?t.resolve(m.__await).then((function(e){i("next",e,o,s)}),(function(e){i("throw",e,o,s)})):t.resolve(m).then((function(e){c.value=e,o(c)}),(function(e){return i("throw",e,o,s)}))}s(l.arg)}var r;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){i(e,n,t,a)}))}return r=r?r.then(a,a):a()}})}function M(t,i,n){var a=u;return function(r,o){if(a===d)throw new Error("Generator is already running");if(a===g){if("throw"===r)throw o;return{value:e,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var l=A(s,n);if(l){if(l===f)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===u)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=d;var c=h(t,i,n);if("normal"===c.type){if(a=n.done?g:"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=g,n.method="throw",n.arg=c.arg)}}}function A(t,i){var n=i.method,a=t.iterator[n];if(a===e)return i.delegate=null,"throw"===n&&t.iterator.return&&(i.method="return",i.arg=e,A(t,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var r=h(a,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,f;var o=r.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,f):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,f)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function j(t){if(t||""===t){var i=t[o];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,r=function i(){for(;++a<t.length;)if(n.call(t,a))return i.value=t[a],i.done=!1,i;return i.value=e,i.done=!0,i};return r.next=r}}throw new TypeError(b(t)+" is not iterable")}return p.prototype=v,a(L,"constructor",{value:v,configurable:!0}),a(v,"constructor",{value:p,configurable:!0}),p.displayName=c(v,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,l,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},C(O.prototype),c(O.prototype,s,(function(){return this})),t.AsyncIterator=O,t.async=function(e,i,n,a,r){void 0===r&&(r=Promise);var o=new O(m(e,i,n,a),r);return t.isGeneratorFunction(i)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},C(L),c(L,l,"Generator"),c(L,o,(function(){return this})),c(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var n in t)i.push(n);return i.reverse(),function e(){for(;i.length;){var n=i.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=j,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function a(n,a){return s.type="throw",s.arg=t,i.next=n,a&&(i.method="next",i.arg=e),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),S(i),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var n=i.completion;if("throw"===n.type){var a=n.arg;S(i)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:j(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),f}},t}function k(e,t,i,n,a,r,o){try{var s=e[r](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function L(e){return function(){var t=this,i=arguments;return new Promise((function(n,a){var r=e.apply(t,i);function o(e){k(r,n,a,o,s,"next",e)}function s(e){k(r,n,a,o,s,"throw",e)}o(void 0)}))}}function C(e,t,i,n,a,r,o,s){var l=[];for(var c in o(!S(i,e)),l.push(function(e,t,i,n,a,r,o){return O.apply(this,arguments)}(i,e,r,i.mainImgUrl,i.mainImgMask,o,s)),e)l.push(M(i,e,"item".concat(c),n,a,r,o));return Promise.all(l)}function O(){return(O=L(w().mark((function e(t,i,n,a,r,o,s){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.mainImgLoaded){e.next=2;break}return e.abrupt("return");case 2:return t.mainImg=new Image,e.abrupt("return",I(a,r).then((function(e){return t.mainImg.src=e,t.mainImg.crossOrigin="anonymous",new Promise((function(e){return t.mainImg.onload=e})).then((function(){s(t.mainImg.width,t.mainImg.height),t.mainImgLoaded=!0,E(t,i,n,o)}))})).catch((function(){throw t.mainImgLoaded=!1,new Error("Main image or mask not found")})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,i,n,a,r,o){return A.apply(this,arguments)}function A(){return(A=L(w().mark((function e(t,i,n,a,r,o,s){var l,c,m,h,u,d;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t["".concat(n,"ImgUrl")],c=t["".concat(n,"ImgMaskUrl")],m="".concat(n,"Loaded"),h=t["".concat(n,"FullImageMask")],!t[m]){e.next=6;break}return e.abrupt("return");case 6:if(t[n]=new Image,h){e.next=11;break}return e.abrupt("return",I(l,c).then(function(){var e=L(w().mark((function e(a){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t[n].src=a,t[n].crossOrigin="anonymous",e.abrupt("return",new Promise((function(e,i){t[n].onload=e,t[n].onerror=i})).then((function(){t[m]=!0,E(t,i,o,s)})).catch((function(){t[m]=!1,E(t,i,o,s)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){throw t[m]=!1,new Error("Item image not found or image with mask could not be generated",m)})));case 11:return u=i[n.replace("item","")],d=t.enableRotation&&u?u.angle:0,e.abrupt("return",I(l,c,u,d,a,r).then(function(){var e=L(w().mark((function e(a){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t[n].src=a,t[n].crossOrigin="anonymous",e.abrupt("return",new Promise((function(e,i){t[n].onload=e,t[n].onerror=i})).then((function(){t[m]=!0,E(t,i,o,s)})).catch((function(){t[m]=!0,E(t,i,o,s)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){throw t[m]=!1,new Error("Item image not found or image with mask could not be generated",m)})));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t,i,n){S(e,t)&&(n(!1),i())}function S(e,t){var i=!0===e.mainImgLoaded;for(var n in t)i=i&&!0===e["item".concat(n,"Loaded")];return i}function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function U(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach((function(t){R(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function R(e,t,i){return(t=F(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function F(e){var t=function(e,t){if("object"!==P(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===P(t)?t:String(t)}i.r(t);var _=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};B(this,e),this.canvas=document.createElement("canvas"),this.wrapperEl=null,this.pixelDensity=window.devicePixelRatio>1?2:1,this.ctx=null,this.width=0,this.height=0,this.overlayType="item",this.overlayOpacity=1,this.xShiftPerPixel=0,this.yShiftPerPixel=0,this.zoom=1,this.loadingBlur=t.loadingBlur?t.loadingBlur:"5px",this.loadingGrayscale=t.loadingGrayscale?t.loadingGrayscale:"1",this.loadingOpacity=t.loadingOpacity?t.loadingOpacity:"0.8",this.autoScale=!0,this.combine=!1,this.mouseDownCallback=t.mouseDownCallback?t.mouseDownCallback:null,this.mouseUpCallback=t.mouseUpCallback?t.mouseUpCallback:null,this.mouseMoveCallback=t.mouseMoveCallback?t.mouseMoveCallback:null,this.images={mainImg:new Image,mainImgUrl:null,mainImgMask:null,mainImgOpacity:null,mainImgLayer:128,mainImgScale:1,mainImgLoaded:!1,mainImgDrawCallback:null,mainImgBrightness:!1,mainImgCoordinates:{x1:0,y1:0,x2:1,y2:1},mainImgAngle:0,enableRotation:!0,blockAspectRatio:!1},this.removedIds=[],this.staticIds=[],this.items=[],this.getRatio=function(){return(t.height||1250)/(t.width||2400)},this.init(t)}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.wrapperEl=t.el||document.getElementById(t.elId||"as_visualizer"),t.combine&&(this.combine=!0),!1===t.autoScale&&(this.autoScale=!1),this.wrapperEl&&(this.wrapperEl.appendChild(this.canvas),this.canvas.style.width="100%",this.ctx=this.canvas.getContext("2d"),!0===this.autoScale&&(this.rescale(),setInterval((function(){e.rescale()}),300),window.addEventListener("resize",this.rescale.bind(this))))}},{key:"rescale",value:function(){this.width===this.wrapperEl.clientWidth*this.pixelDensity&&this.canvas.width===this.width||(this.width=this.wrapperEl.clientWidth*this.pixelDensity,this.height=this.width*this.getRatio(),this.canvas.width=this.width,this.canvas.height=this.height,this.xShiftPerPixel=this.canvas.width>0?1/this.canvas.width:0,this.yShiftPerPixel=this.canvas.height>0?1/this.canvas.height:0,this.render())}},{key:"loadImagesAndRender",value:function(){var e=this;return new Promise((function(t,i){C(e.items,e.removedIds,e.images,e.width,e.height,e.render.bind(e),e.setLoading.bind(e),e.setRatio.bind(e)).then((function(){e.width=e.wrapperEl.clientWidth*e.pixelDensity,e.height=e.width*e.getRatio(),t()})).catch((function(){e.width=e.wrapperEl.clientWidth*e.pixelDensity,e.height=e.width*e.getRatio(),e.clear(),i()}))}))}},{key:"render",value:function(){var e=this;if(!this.images.mainImgLoaded)for(var t in this.items)if(!this.images["item".concat(t,"Loaded")])return;window.requestAnimationFrame((function(){v(e.items,e.removedIds,e.ctx,e.width,e.height,e.images,e.staticIds,e.overlayType,e.overlayOpacity,e.pixelDensity)}))}},{key:"setRatio",value:function(e,t){return this.width=0,this.height=0,this.getRatio=function(){return(t||1200)/(e||2300)},this.rescale.bind(this),this.render.bind(this),{width:e,height:t,ratio:this.getRatio()}}},{key:"setMainImg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o={url:e,coordinates:t,angle:i,drawCallback:n,brightness:a,opacity:r};if(this.images.mainImgUrl!==e)return null!==o.brightness&&"number"!=typeof o.brightness?(console.warn("Brightness configuration received is not a number"),o):(this.images.mainImgUrl=o.url,this.images.mainImgMask=null,this.images.mainImgOpacity=o.opacity,this.images.mainImgLoaded=!1,this.images.mainImgDrawCallback=o.drawCallback,this.images.mainImgBrightness=o.brightness,this.images.mainImgCoordinates=o.coordinates?o.coordinates:U({},this.images.mainImgCoordinates),this.images.mainImgAngle=o.angle,o)}},{key:"setMainImgWithMask",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s={url:e,mask:t,coordinates:i,angle:n,drawCallback:a,brightness:r,opacity:o};return null!==s.brightness&&"number"!=typeof s.brightness?(console.warn("Brightness configuration received is not a number"),s):(this.images.mainImgUrl=s.url,this.images.mainImgMask=s.mask,this.images.mainImgOpacity=s.opacity,this.images.mainImgLoaded=!1,this.images.mainImgDrawCallback=s.drawCallback,this.images.mainImgBrightness=s.brightness,this.images.mainImgCoordinates=s.coordinates?s.coordinates:U({},this.images.mainImgCoordinates),this.images.mainImgAngle=s.angle,s)}},{key:"getMainImg",value:function(){return this.images.mainImgUrl}},{key:"getMainImgMask",value:function(){return this.images.mainImgMask}},{key:"setMainImgScale",value:function(e){e>1||e<0||!e?console.error("Main image scale must be more than 0 and less or equals to 1"):this.images.mainImgScale!==e&&(this.images.mainImgScale=e,this.images.mainImgLoaded=!1)}},{key:"setMainImgCoordinates",value:function(e){var t={newCoordinates:e};return null==e.x1||null==e.y1||null==e.x2||null==e.y2?console.error("Coordinates not set. New coordinates requires 'x1', 'x2', 'y1' and 'y2'"):this.images.mainImgCoordinates={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},t}},{key:"setMainImgAngle",value:function(e){var t={newAngle:e};return"number"!=typeof e?console.error("Angle not set. New angle requires a number as value"):(this.images.enableRotation=!0,this.images.mainImgAngle=e),t}},{key:"setMainImgOpacity",value:function(e){this.images.mainImgOpacity=e}},{key:"setItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c={url:e,coordinates:i,layer:n,angle:a,drawCallback:r,brightness:o,opacity:s,useAntialiasing:l,index:t};if(c.index&&this.images["item".concat(c.index,"ImgUrl")]&&this.images["item".concat(c.index,"ImgUrl")]===c.url)return console.warn("Image not changed"),this.images["item".concat(c.index,"Loaded")]=!1,this.items[c.index].drawCallback=c.drawCallback,this.items[c.index].brightness=c.brightness,this.items[c.index].opacity=c.opacity,c.coordinates&&this.setItemCoordinates(c.coordinates,c.index),c.layer&&this.setItemLayer(c.layer,c.index),c.angle&&this.setItemAngle(c.angle,c.index),c;if("number"==typeof c.index&&c.index>=0&&this.images["item".concat(c.index,"ImgUrl")])return this.images["item".concat(c.index,"ImgUrl")]=c.url,this.images["item".concat(c.index,"Loaded")]=!1,this.items[c.index].drawCallback=c.drawCallback,this.items[c.index].brightness=c.brightness,this.items[c.index].opacity=c.opacity,c.coordinates&&this.setItemCoordinates(c.coordinates,c.index),c.layer&&this.setItemLayer(c.layer,c.index),c.angle&&this.setItemAngle(c.angle,c.index),c;if(c.url){var m="number"==typeof t?t:this.getLastItemIndex();return c.index=m,this.images["item".concat(c.index)]=new Image,this.images["item".concat(c.index,"ImgUrl")]=c.url,this.images["item".concat(c.index,"ImgMaskUrl")]=null,this.images["item".concat(c.index,"FullImageMask")]=!1,this.images["item".concat(c.index,"Layer")]=c.index,this.images["item".concat(c.index,"Loaded")]=!1,this.items[c.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:c.drawCallback,brightness:c.brightness,opacity:c.opacity,useAntialiasing:c.useAntialiasing},i&&this.setItemCoordinates(i,c.index),c.layer&&this.setItemLayer(c.layer,c.index),c.angle&&this.setItemAngle(c.angle,c.index),c}console.warn("Item not added",c)}},{key:"setItemWithMask",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,m=arguments.length>10&&void 0!==arguments[10]&&arguments[10],h={url:e,mask:t,coordinates:n,layer:a,angle:r,drawCallback:o,useMaskOnFullImage:s,brightness:l,opacity:c,useAntialiasing:m,index:i};if(h.index&&this.images["item".concat(h.index,"ImgUrl")]&&this.images["item".concat(h.index,"ImgUrl")]===h.url)return console.warn("Image not changed"),this.images["item".concat(h.index,"Loaded")]=!1,this.images["item".concat(h.index,"ImgMaskUrl")]=h.mask,this.images["item".concat(h.index,"FullImageMask")]=h.useMaskOnFullImage,this.images["item".concat(h.index,"Loaded")]=!1,this.items[h.index].drawCallback=h.drawCallback,this.items[h.index].brightness=h.brightness,this.items[h.index].opacity=h.opacity,h.coordinates&&this.setItemCoordinates(h.coordinates,h.index),h.layer&&this.setItemLayer(h.layer,h.index),h.angle&&this.setItemAngle(h.angle,h.index),h;if("number"==typeof h.index&&h.index>=0&&this.images["item".concat(h.index,"ImgUrl")])return this.images["item".concat(h.index,"ImgUrl")]=h.url,this.images["item".concat(h.index,"ImgMaskUrl")]=h.mask,this.images["item".concat(h.index,"FullImageMask")]=h.useMaskOnFullImage,this.images["item".concat(h.index,"Loaded")]=!1,this.items[h.index].drawCallback=h.drawCallback,this.items[h.index].brightness=h.brightness,this.items[h.index].opacity=h.opacity,h.coordinates&&this.setItemCoordinates(h.coordinates,h.index),h.layer&&this.setItemLayer(h.layer,h.index),h.angle&&this.setItemAngle(h.angle,h.index),h;if(h.url){var u="number"==typeof h.index?h.index:this.getLastItemIndex();return h.index=u,this.images["item".concat(h.index)]=new Image,this.images["item".concat(h.index,"ImgUrl")]=h.url,this.images["item".concat(h.index,"ImgMaskUrl")]=h.mask,this.images["item".concat(h.index,"FullImageMask")]=h.useMaskOnFullImage,this.images["item".concat(h.index,"Layer")]=h.index,this.images["item".concat(h.index,"Loaded")]=!1,this.items[h.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:h.drawCallback,brightness:h.brightness,opacity:h.opacity,useAntialiasing:h.useAntialiasing},h.coordinates&&this.setItemCoordinates(h.coordinates,h.index),h.layer&&this.setItemLayer(h.layer,h.index),h.angle&&this.setItemAngle(h.angle,h.index),h}console.warn("Item not added",h)}},{key:"setItemImg",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o={url:e,drawCallback:i,brightness:n,opacity:a,useAntialiasing:r,index:t};if(o.index&&this.images["item".concat(o.index,"ImgUrl")]&&this.images["item".concat(o.index,"ImgUrl")]===o.url)return console.warn("Image not changed"),this.images["item".concat(o.index,"Loaded")]=!1,this.items[o.index].drawCallback=o.drawCallback,this.items[o.index].brightness=o.brightness,this.items[o.index].opacity=o.opacity,o;if("number"==typeof o.index&&o.index>=0&&this.images["item".concat(o.index,"ImgUrl")])return this.images["item".concat(o.index,"ImgUrl")]=o.url,this.images["item".concat(o.index,"Loaded")]=!1,this.items[o.index].drawCallback=o.drawCallback,this.items[o.index].brightness=o.brightness,this.items[o.index].opacity=o.opacity,o;if(e){var s="number"==typeof t?t:this.getLastItemIndex();return o.index=s,this.images["item".concat(o.index)]=new Image,this.images["item".concat(o.index,"ImgUrl")]=o.url,this.images["item".concat(o.index,"ImgMaskUrl")]=null,this.images["item".concat(o.index,"Layer")]=o.index,this.images["item".concat(o.index,"Loaded")]=!1,this.items[o.index]={coordinates:{},originalCoordinates:{},angle:0,originalAngle:0,linkedItems:[],drawCallback:o.drawCallback,brightness:o.brightness,opacity:o.opacity,useAntialiasing:o.useAntialiasing},o}console.warn("Item not added",o)}},{key:"removeItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={index:e};this.images["item".concat(t.index,"ImgUrl")]||console.error("Item with index ".concat(t.index," not found"));var i=this.images["item".concat(t.index,"ImgUrl")],n=this.images["item".concat(t.index,"ImgMaskUrl")],a=this.images["item".concat(t.index,"FullImageMask")],r=this.images["item".concat(t.index,"Layer")],o=this.items[t.index];return this.removedIds.push(t.index),{url:i,mask:n,useMaskOnFullImage:a,layer:r,index:t.index,item:o}}},{key:"setItemLayer",value:function(e,t){var i={layer:e,index:t};return"number"!=typeof t?console.error("Layer not set. Index value required"):0===Math.round(e)||e>this.images.mainImgLayer?console.error("Layer not set. Layer for ITEM ".concat(t," should be more or less than 0, and not more than ").concat(this.images.mainImgLayer)):this.images["item".concat(t)]&&this.images["item".concat(t,"ImgUrl")]?(this.images["item".concat(t,"Loaded")]=!1,this.images["item".concat(t,"Layer")]=e):console.error("Layer not set. Item doesn't exists with this index ".concat(t)),i}},{key:"setItemCoordinates",value:function(e,t){var i={newCoordinates:e,index:t};return"number"!=typeof t?console.error("Coordinates not set. Index value required"):null==e.x1||null==e.y1||null==e.x2||null==e.y2?console.error("Coordinates not set. New coordinates requires 'x1', 'x2', 'y1' and 'y2'"):this.images["item".concat(t)]&&this.images["item".concat(t,"ImgUrl")]?(this.items[t].coordinates={x1:+e.x1,y1:+e.y1,x2:+e.x2,y2:+e.y2},this.items[t].originalCoordinates.length||(this.items[t].originalCoordinates={x1:+e.x1,y1:+e.y1,x2:+e.x2,y2:+e.y2})):console.error("Coordinates not set. Item doesn't exists with this index ".concat(t)),i}},{key:"setItemOpacity",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0,n={opacity:t,index:i};return"number"!=typeof n.index?console.error("Opacity not set. Index value required"):"number"!=typeof n.opacity?console.error("Opacity not set. New opacity requires a number as value"):this.images["item".concat(n.index)]&&this.images["item".concat(n.index,"ImgUrl")]?(this.items[i].opacity=n.opacity,this.items[i].linkedItems.forEach((function(t){e.items[t].opacity=n.opacity}))):console.error("Opacity not set. Item doesn't exists with this index ".concat(n.index)),n}},{key:"setItemAngle",value:function(e,t){var i=this,n={angle:e,index:t};return"number"!=typeof t?console.error("Angle not set. Index value required"):"number"!=typeof e?console.error("Angle not set. New angle requires a number as value"):this.images["item".concat(t)]&&this.images["item".concat(t,"ImgUrl")]?(this.images.enableRotation=!0,0===this.items[t].angle&&0===this.items[t].originalAngle&&0!=e&&(this.items[t].originalAngle=e),this.items[t].angle=n.angle,this.items[t].linkedItems.forEach((function(e){var t=i.items[e].originalAngle;i.items[e].angle=i.items[e].useBaseItemCoordinatesAsReference?n.angle+t:n.angle}))):console.error("Angle not set. Item doesn't exists with this index ".concat(t)),n}},{key:"setItemScale",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(t<0)console.error("Scale value must be more than 0");else{if(t>=0&&i>=0){var r=!1,o=U({},this.items[i].coordinates),c=(1-t)*(o.x2-o.x1)*-.25,m=(1-t)*(o.y2-o.y1)*-.25;return"x"!==a&&(this.items[i].coordinates.x1=o.x1-("left"===n?0:"right"===n?2*c:c)),"x"!==a&&(this.items[i].coordinates.x2=o.x2+("right"===n?0:"left"===n?2*c:c)),"y"!==a&&(this.items[i].coordinates.y1=o.y1-("top"===n?0:"bottom"===n?2*m:m)),"y"!==a&&(this.items[i].coordinates.y2=o.y2+("bottom"===n?0:"top"===n?2*m:m)),this.items[i].linkedItems.forEach((function(c){if(!0===e.items[c].useBaseItemCoordinatesAsReference)e.items[c].coordinates=s(e.items[i].coordinates,l(o,e.items[c].coordinates));else{var m=U({},e.items[c].coordinates),h=(1-t)*(m.x2-m.x1)*-.25,u=(1-t)*(m.y2-m.y1)*-.25;"x"!==a&&(e.items[c].coordinates.x1=e.items[c].coordinates.x1-("left"===n?0:"right"===n?2*h:h)),"x"!==a&&(e.items[c].coordinates.x2=e.items[c].coordinates.x2+("right"===n?0:"left"===n?2*h:h)),"y"!==a&&(e.items[c].coordinates.y1=e.items[c].coordinates.y1-("top"===n?0:"bottom"===n?2*u:u)),"y"!==a&&(e.items[c].coordinates.y2=e.items[c].coordinates.y2+("bottom"===n?0:"top"===n?2*u:u))}r=!0})),{item:this.items[i],scale:t,oldCoordinates:o,newCoordinates:this.items[i].coordinates,affectedLinkedItems:r}}console.error("Scale must be more than 0 or Item index is not set")}}},{key:"setItemLink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return null===e||null===t?console.error("Base item index or linked item index is not set"):void 0===this.items[t]||void 0===this.items[e]?console.error("Items with index ".concat(t," or ").concat(e," doesn't exist")):i&&!this.items[e].coordinates?console.error("Base item with index ".concat(e," doesn't have coordinates set")):i&&!this.items[t].coordinates?console.error("Linked item with index ".concat(t," doesn't have coordinates set")):this.images["item".concat(e)]&&this.items[e]?this.images["item".concat(t)]?(this.items[e].linkedItems.push(t),i&&(this.items[t].coordinates=U({},s(this.items[e].coordinates,this.items[t].coordinates)),this.items[t].useBaseItemCoordinatesAsReference=!0)):console.error("Linked item with index ".concat(t," not found")):console.error("Base item with index ".concat(e," not found")),{baseItemIndex:e,linkedItemIndex:t,useBaseItemCoordinatesAsReference:i}}},{key:"setItemUnlink",value:function(e,t){if(this.images["item".concat(e)]&&this.items[e])if(this.images["item".concat(t)]){var i=this.items[e].linkedItems.indexOf(t);delete this.items[e].linkedItems[i]}else console.error("Linked item with index ".concat(t," not found"));else console.error("Base item with index ".concat(e," not found"));return{baseItemIndex:e,linkedItemIndex:t}}},{key:"setItemAntialiasing",value:function(e,t){var i={useAntialiasing:e,index:t};return"number"!=typeof t?console.error("Antialiasing not set. Index value required"):"boolean"!=typeof e?console.error("Antialiasing not set. New antialiasing requires a boolean as value"):(this.images["item".concat(t,"Loaded")]=!1,this.items[t].useAntialiasing=i.useAntialiasing),i}},{key:"setItemAngles",value:function(e){var t={newAngle:e,affectedIds:[]},i=this.getBlockedItemIds();for(var n in this.items)i.includes(parseInt(n))||(this.images.enableRotation=!0,0===this.items[n].angle&&0===this.items[n].originalAngle&&0!=e&&(this.items[n].originalAngle=e),this.items[n].angle=e,t.affectedIds.push(n));return t}},{key:"setZoom",value:function(e){e<1||e>4||(this.zoom=e,this.canvas.style.width=Math.round(1e3*this.zoom)/10+"%",this.wrapperEl.scrollLeft=(this.wrapperEl.scrollWidth-this.wrapperEl.offsetWidth)/2)}},{key:"setLoading",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?(this.wrapperEl.style.transition="filter .33s, opacity .33s",this.wrapperEl.style.filter="blur(".concat(this.loadingBlur,") grayscale(").concat(this.loadingGrayscale,")"),this.wrapperEl.style.opacity="".concat(this.loadingOpacity)):(this.wrapperEl.style.filter="",this.wrapperEl.style.opacity="1")}},{key:"getLastItemIndex",value:function(){return this.items.length}},{key:"getFirstItemLayer",value:function(){var e=this,t=0;return Object.keys(this.images).forEach((function(i){i.includes("Layer")&&i.includes("item")&&e.images[i]<t&&(t=e.images[i])})),t}},{key:"getBlockedItemIds",value:function(){var e=this.staticIds.slice();for(var t in this.items)a(this.images["item".concat(t)].src)||e.push(t);return e}},{key:"getUtils",value:function(){return{drawImageLeftHalf:r,drawImageRightHalf:o,validateSrc:a,getLinkedItemCoordinatesFromBaseItem:s,getOriginalCoordinatesFromLinkedItemWithBaseItem:l,getPercentByUnit:m,scaleCoordinates:c,createCanvasWithBlurredImage:h}}},{key:"resizeToOriginalProportion",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=t||this.combine){this.combine&&null==t&&(t=0);var n=!1,a=i?this.images["item".concat(t)].naturalWidth/this.images["item".concat(t)].naturalHeight:this.images["item".concat(t)].naturalHeight/this.images["item".concat(t)].naturalWidth;if(this.combine)for(var r in this.items)this.getBlockedItemIds().includes(parseInt(r))||(i?this.items[r].coordinates.x2=a*(this.items[t].coordinates.y2-this.items[t].coordinates.y1)*this.height/this.width+this.items[t].coordinates.x1:this.items[r].coordinates.y2=a*(this.items[t].coordinates.x2-this.items[t].coordinates.x1)*this.width/this.height+this.items[t].coordinates.y1);else{var o=U({},this.items[t].coordinates);i?this.items[t].coordinates.x2=a*(this.items[t].coordinates.y2-this.items[t].coordinates.y1)*this.height/this.width+this.items[t].coordinates.x1:this.items[t].coordinates.y2=a*(this.items[t].coordinates.x2-this.items[t].coordinates.x1)*this.width/this.height+this.items[t].coordinates.y1,this.items[t].linkedItems.forEach((function(a){if(e.items[a].useBaseItemCoordinatesAsReference)e.items[a].coordinates=s(e.items[t].coordinates,l(o,e.items[a].coordinates));else{var r=i?e.images["item".concat(a)].naturalWidth/e.images["item".concat(a)].naturalHeight:e.images["item".concat(a)].naturalHeight/e.images["item".concat(a)].naturalWidth;i?e.items[a].coordinates.x2=r*(e.items[a].coordinates.y2-e.items[a].coordinates.y1)*e.height/e.width+e.items[a].coordinates.x1:e.items[a].coordinates.y2=r*(e.items[a].coordinates.x2-e.items[a].coordinates.x1)*e.width/e.height+e.items[a].coordinates.y1}n=!0}))}return{item:this.items[t],index:t,horizontal:i,affectedLinkedItems:n}}console.error("Item index not set. Index is required if 'Combine' option is not set to the visualizer")}},{key:"download",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image.png",t=document.createElement("a");t.download=e,t.href=this.canvas.toDataURL(),t.click()}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.ctx.clearRect(0,0,this.width,this.height),e&&this.reset()}},{key:"reset",value:function(){var e=U({},this.images);this.staticIds=[],this.items=[],this.images={mainImg:new Image,mainImgUrl:null,mainImgMask:null,mainImgOpacity:null,mainImgScale:1,mainImgLoaded:!1,mainImgDrawCallback:null,mainImgBrightness:!1,mainImgCoordinates:{x1:0,y1:0,x2:1,y2:1},mainImgAngle:0,mainImgLayer:128,enableRotation:e.enableRotation},this.zoom=1,this.overlayOpacity=1}},{key:"resetItems",value:function(){var e=U({},this.images);this.staticIds=[],this.items=[],this.images={mainImg:e.mainImg,mainImgUrl:e.mainImgUrl,mainImgMask:e.mainImgMask,mainImgOpacity:e.mainImgOpacity,mainImgScale:e.mainImgScale,mainImgLoaded:e.mainImgLoaded,mainImgDrawCallback:e.mainImgDrawCallback,mainImgBrightness:e.mainImgBrightness,mainImgCoordinates:e.mainImgCoordinates,mainImgAngle:e.mainImgAngle,mainImgLayer:e.mainImgLayer,enableRotation:e.enableRotation}}}])&&D(t.prototype,i),n&&D(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.default=_},,,,function(e,t,i){e.exports=i(5)},function(e,t,i){"use strict";i.r(t);var n=i(0);window.initASCanvas=n.default}]);