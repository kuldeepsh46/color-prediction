@section('css')<style>    td {        color: white;    }</style>@endsection@extends('Layout.usergame2')@section('content')<div class="modal fade view-ticket-modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">  <div class="modal-dialog modal-lg">    <div class="modal-content">      <div class="modal-header">        <h4 class="modal-title" id="myLargeModalLabel">View Ticket</h4>        <button type="button" class="close" data-dismiss="modal" aria-label="Close">          <span aria-hidden="true">Ã—</span>        </button>      </div>      <div class="modal-body">        <div class='chatSection'></div>        <input type='text' id='ticketReply' name='ticketReply' />        <button class='btn btn-sm btn-success view-ticket' onclick='sendReply();'>Send</button>      </div>    </div>  </div></div>    <table class="table">  <thead>    <tr class="table-dark">      <th scope="col">#</th>      <th scope="col">Subject</th>      <th scope="col">Message</th>      <th scope="col">Status</th>      <!--<th scope="col">Action</th>-->    </tr>  </thead>  <tbody>      @if(count($userAllTickets) > 0)      @foreach($userAllTickets as $tickets)      <tr>          <td>{{$tickets[0]['id']}}</td>          <td>{{$tickets[0]['subject']}}</td>          <td><button class="btn btn-sm btn-success view-ticket" onclick="viewTicket('<?php echo htmlspecialchars(json_encode($tickets)); ?>');">View Ticket</button></td>          <td>              @if($tickets[0]['status'] == 0)              Processing              @else              Closed              @endif          </td>        @foreach($tickets as $ticket)                @endforeach      </tr>      @endforeach      @else            @endif  </tbody></table>@endsection@section('js')<script>function viewTicket(ticketData) {            var ticketData = JSON.parse(ticketData);            console.log(ticketData)            $('.view-ticket-modal').addClass('show');            $('.view-ticket-modal').css('display', 'block');            $('.chatSection').prepend("<input type='hidden' name='ticketId' id='ticketId' value='"+ticketData[0].ticketId+"' /><span class='senderName'>"+ticketData[0].name+"</span>")            ticketData.forEach((item) => {                if(item.userType == 1 && item.message != null) {                    $(".chatSection").append("<div class='senderMsg admin'>"+item.message+"</div>");                } else {                                        if(item.message != null) {                        $(".chatSection").append("<div class='senderMsg user'>"+item.message+"</div>");                    }                }            });        }        function sendReply() {            let formData = new FormData();                        var ticketId = $('#ticketId').val();            formData.append('ticketId', ticketId);                        formData.append('ticketReply', $('#ticketReply').val());            formData.append('_token', '{{ csrf_token() }}');                        $.ajax({                url: "{{ url('/reply/ticket') }}",                type: 'POST',                data: formData,                processData: false,                contentType: false,                success: function(response) {                    $('#ticketReply').val('');                    var ticketData = response.data[ticketId];                    $(".chatSection").html('');                    ticketData.forEach((item) => {                        if(item.userType == 1 && item.message != null) {                            $(".chatSection").append("<div class='senderMsg admin'>"+item.message+"</div>");                        } else {                            if(item.message != null) {                                $(".chatSection").append("<div class='senderMsg user'>"+item.message+"</div>");                            }                        }                    });                },                error: function(error) {                }            });        }    $('.view-ticket-modal').find('.close').click(() => {        $('.chatSection').html('');        $('.view-ticket-modal').removeClass('show');        $('.view-ticket-modal').css('display', 'none');    });</script>@endsection